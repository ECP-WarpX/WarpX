#!/usr/bin/env python3

# 2023 TAE Technologies

import os
import sys

import numpy as np

sys.path.append('../../../../warpx/Regression/Checksum/')

import checksumAPI

# this will be the name of the plot file
fn = sys.argv[1]
test_name = os.path.split(os.getcwd())[1]

my_check = checksumAPI.evaluate_checksum(test_name, fn, do_particles=True)

ref_density = np.array([
    1.27945114e+14, 2.23583642e+14, 2.55392166e+14, 2.55655614e+14,
    2.55811304e+14, 2.55813038e+14, 2.55817129e+14, 2.55752279e+14,
    2.55912208e+14, 2.56079483e+14, 2.55932916e+14, 2.55822911e+14,
    2.55910910e+14, 2.55995538e+14, 2.56185960e+14, 2.56518490e+14,
    2.56843281e+14, 2.56847244e+14, 2.56317496e+14, 2.55995033e+14,
    2.56036918e+14, 2.56185305e+14, 2.56473454e+14, 2.56612720e+14,
    2.56460349e+14, 2.56162495e+14, 2.56154687e+14, 2.56351568e+14,
    2.56518116e+14, 2.56589716e+14, 2.56491198e+14, 2.56462652e+14,
    2.56475832e+14, 2.56502009e+14, 2.56512082e+14, 2.56400671e+14,
    2.56317027e+14, 2.56348890e+14, 2.56604754e+14, 2.56846626e+14,
    2.56749617e+14, 2.56563946e+14, 2.56508159e+14, 2.56706913e+14,
    2.56921135e+14, 2.56772946e+14, 2.56509222e+14, 2.56556290e+14,
    2.56632138e+14, 2.56452482e+14, 2.56371644e+14, 2.56363151e+14,
    2.56471549e+14, 2.56541772e+14, 2.56342768e+14, 2.56345629e+14,
    2.56415143e+14, 2.56259609e+14, 2.56264787e+14, 2.56619762e+14,
    2.56992843e+14, 2.57102387e+14, 2.56719391e+14, 2.56255624e+14,
    2.56276638e+14, 2.56350832e+14, 2.56295294e+14, 2.56153556e+14,
    2.56170347e+14, 2.56246380e+14, 2.56088509e+14, 2.56121028e+14,
    2.56423889e+14, 2.56597963e+14, 2.56470310e+14, 2.56419968e+14,
    2.56625715e+14, 2.56711965e+14, 2.56651610e+14, 2.56750226e+14,
    2.56743475e+14, 2.56616083e+14, 2.56830920e+14, 2.57164423e+14,
    2.56868182e+14, 2.56749114e+14, 2.57108990e+14, 2.56791445e+14,
    2.56203737e+14, 2.56114492e+14, 2.56630346e+14, 2.24843400e+14,
    1.28200732e+14
])

density_data = np.load( 'ion_density_case_1.npy' )
print(repr(density_data))
assert np.allclose(density_data, ref_density)
