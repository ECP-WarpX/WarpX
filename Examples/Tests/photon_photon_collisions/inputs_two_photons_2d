#################################
####### GENERAL PARAMETERS ######
#################################
max_step = 400
amr.n_cell = 8 8
amr.max_grid_size = 8
amr.blocking_factor = 8
amr.max_level = 0
geometry.dims = 2
geometry.prob_lo = -4 -4
geometry.prob_hi = 4 4

#################################
##### BOUNDARY CONDITIONS #######
#################################
boundary.field_lo = periodic periodic
boundary.field_hi = periodic periodic

#################################
############ NUMERICS ###########
#################################
warpx.verbose = 1
warpx.cfl = 1.0
algo.particle_shape = 1

#################################
############ PLASMA #############
#################################
particles.species_names = photonA photonB electron positron
particles.photon_species = photonA photonB

photonA.species_type = photon
photonA.injection_style = "SingleParticle"
photonA.single_particle_pos = 0 0 0
photonA.single_particle_vel = 2.7 0 0 # gamma times beta
photonA.single_particle_weight = 1e53
photonA.do_not_push = 1
photonA.do_not_deposit = 1

photonB.species_type = photon
photonB.injection_style = "SingleParticle"
photonB.single_particle_pos = 0 0 0
photonB.single_particle_vel = -2.7 0 0 # gamma times beta
photonB.single_particle_weight = 1e53
photonB.do_not_push = 1
photonB.do_not_deposit = 1

electron.species_type = electron
electron.injection_style = none
electron.do_not_push = 1
electron.do_not_deposit = 1

positron.species_type = positron
positron.injection_style = none
positron.do_not_push = 1
positron.do_not_deposit = 1

#################################
############ COLLISION ##########
#################################
collisions.collision_names = LBW # linear Breit-Wheeler
LBW.species = photonA photonB
LBW.product_species = electron positron
LBW.type = photonphoton
LBW.fusion_multiplier = 1.
LBW.fusion_probability_threshold = 0.1

# Full diagnostics
diagnostics.diags_names = particles
particles.intervals = 1
particles.diag_type = Full
particles.fields_to_plot = none
particles.write_species = 1
particles.species = photonA photonB electron positron
particles.format = openpmd
particles.openpmd_backend = bp
particles.dump_last_timestep = 1


my_constants.out_freq_red = 1
# Reduced diagnostics
warpx.reduced_diags_names = FieldEnergy FieldMomentum FieldMaximum ParticleExtrema_photonA ParticleExtrema_photonB ParticleExtrema_electron ParticleExtrema_positron ParticleEnergy ParticleMomentum RhoMaximum ParticleNumber BeamRelevant_photonA BeamRelevant_photonB BeamRelevant_electron BeamRelevant_positron

FieldEnergy.type = FieldEnergy
FieldEnergy.intervals = out_freq_red

FieldMomentum.type = FieldMomentum
FieldMomentum.intervals = out_freq_red

FieldMaximum.type = FieldMaximum
FieldMaximum.intervals = out_freq_red

ParticleExtrema_photonA.type = ParticleExtrema
ParticleExtrema_photonA.intervals = out_freq_red
ParticleExtrema_photonA.species = photonA

ParticleExtrema_photonB.type = ParticleExtrema
ParticleExtrema_photonB.intervals = out_freq_red
ParticleExtrema_photonB.species = photonB

ParticleExtrema_electron.type = ParticleExtrema
ParticleExtrema_electron.intervals = out_freq_red
ParticleExtrema_electron.species = electron

ParticleExtrema_positron.type = ParticleExtrema
ParticleExtrema_positron.intervals = out_freq_red
ParticleExtrema_positron.species = positron

ParticleEnergy.type = ParticleEnergy
ParticleEnergy.intervals = out_freq_red

ParticleMomentum.type = ParticleMomentum
ParticleMomentum.intervals = out_freq_red

RhoMaximum.type = RhoMaximum
RhoMaximum.intervals = out_freq_red

ParticleNumber.type = ParticleNumber
ParticleNumber.intervals = out_freq_red

BeamRelevant_photonA.type = BeamRelevant
BeamRelevant_photonA.species = photonA
BeamRelevant_photonA.intervals = out_freq_red

BeamRelevant_photonB.type = BeamRelevant
BeamRelevant_photonB.species = photonB
BeamRelevant_photonB.intervals = out_freq_red

BeamRelevant_electron.type = BeamRelevant
BeamRelevant_electron.species = electron
BeamRelevant_electron.intervals = out_freq_red

BeamRelevant_positron.type = BeamRelevant
BeamRelevant_positron.species =    positron
BeamRelevant_positron.intervals = out_freq_red
