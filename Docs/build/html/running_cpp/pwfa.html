

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>In-depth explanation of a PWFA simulation &mdash; WarpX  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Running WarpX from Python" href="../running_python/running_python.html" />
    <link rel="prev" title="Running on specific platforms" href="platforms.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> WarpX
          

          
          </a>

          
            
            
              <div class="version">
                20.02
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../building/building.html">Building/installing WarpX</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="running_cpp.html">Running WarpX as an executable</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="how_to_run.html">How to run a new simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples.html">Example input files</a></li>
<li class="toctree-l2"><a class="reference internal" href="parameters.html">Input parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="profiling.html">Profiling the code</a></li>
<li class="toctree-l2"><a class="reference internal" href="parallelization.html">Parallelization in  WarpX</a></li>
<li class="toctree-l2"><a class="reference internal" href="platforms.html">Running on specific platforms</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">In-depth explanation of a PWFA simulation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../running_python/running_python.html">Running WarpX from Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../visualization/visualization.html">Visualizing the simulation results</a></li>
<li class="toctree-l1"><a class="reference internal" href="../theory/theory.html">Theoretical background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developers/developers.html">Developers documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developers/doxygen.html">Doxygen</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">WarpX</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="running_cpp.html">Running WarpX as an executable</a> &raquo;</li>
        
      <li>In-depth explanation of a PWFA simulation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/running_cpp/pwfa.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="in-depth-explanation-of-a-pwfa-simulation">
<h1>In-depth explanation of a PWFA simulation<a class="headerlink" href="#in-depth-explanation-of-a-pwfa-simulation" title="Permalink to this headline">¶</a></h1>
<p>As described in the Introduction
<a class="reference external" href="https://warpx.readthedocs.io/en/latest/theory/intro.html">Introduction</a>, one
of the key applications of the WarpX exascale computing platform is in modelling
future, compact and economic plasma-based accelerators. In this section we
describe the simulation setup of a realistic electron beam driven plasma
wakefield accelerator (PWFA) configuration that can be explored with
<strong>WarpX</strong> using the example linked below <a class="reference download internal" download="" href="../_downloads/8f9b91cee648dd7a4cca4cdeba8dc14b/inputs_2d_boost"><code class="xref download docutils literal notranslate"><span class="pre">PWFA</span></code></a></p>
<p>The simulation setup consists of 4 particle species: drive
beam (driver), witness beam (beam), plasma electrons (plasma_e), and plasma
ions (plasma_p). The species parameters are summarized in the following table.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 13%" />
<col style="width: 87%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Species</p></th>
<th class="head"><p>Parameters</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>driver</p></td>
<td><p>γ = 48923; N = 2x10^8; σz = 4.0 μm; σx = σy = 2.0 μm</p></td>
</tr>
<tr class="row-odd"><td><p>beam</p></td>
<td><p>γ = 48923; N = 6x10^5; σz = 1.0 mm; σx = σy = 0.5 μm</p></td>
</tr>
<tr class="row-even"><td><p>plasma_e</p></td>
<td><p>n = 1x10^23 m^-3</p></td>
</tr>
<tr class="row-odd"><td><p>plasma_p</p></td>
<td><p>n = 1x10^23 m^-3</p></td>
</tr>
</tbody>
</table>
<p>Where γ is the beam relativisitc Lorentz factor, N is the number of particles,
and σx, σy, σz are the beam widths (root-mean-squares of particle positions) in
the transverse (x,y) and longitudinal directions.</p>
<p>The separation between the driver and witness beams is set to 125 μm.</p>
<p>The simulation can be done in the lab frame as well as in a Lorentz-boosted
frame, which is the case of the example considered. In a lab frame simulation,
there is no need to include the plasma ions since they are stationary during the
short time scales of motion of the plasma electrons. In a boosted frame
simulation, that argument is no longer valid as ions have finite velocities.
Therefore plasma_p is also defined in the example without loss of generality.
The key advantage of using the boosted frame is that the computational costs can
be substantially reduced.</p>
<p>In the example input, all the simulation parameters are defined in the lab frame
regardless of if the boosted frame is used. This is true also for the
longitudinal and transverse dimensions of the simulation box, the diagnostic
time snapshots for back-transformed data to the lab frame from a boosted-frame
simulation. Thus, when one defines the grid size in the lab frame, the
longitudinal resolution remains the same, but the transverse grid sizes need to
be adjusted approximately in the boosted frame with the following relation</p>
<p>The time step in the boosted frame is increased as</p>
<p>Here γ is the Lorentz factor of the boosted frame. In the boosted frame with β close to 1 in the forward direction of the beam propagation, the beam length and plasma length change, respectively, according to</p>
<p>Define the total run time of a simulation by the full transit time of the beam through the plasma, and they are given by, respectively in the lab and boosted frame</p>
<p>assuming the plasma moving at c opposite to the beam direction. Thus the number of time steps in the lab and boosted frame are</p>
<p>It should be pointed out that this example is performed in 2D x-y geometry, which is not equivalent to the realistic simulation. However, the fast turnaround time in 2D simulation helps determine the numerical requirements and the optimized boosted frame, which can then be used in 3D simulations.</p>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../running_python/running_python.html" class="btn btn-neutral float-right" title="Running WarpX from Python" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="platforms.html" class="btn btn-neutral float-left" title="Running on specific platforms" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, WarpX collaboration

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>