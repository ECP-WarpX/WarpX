

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Visualizing back-transformed diagnostics &mdash; WarpX  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Reduced diagnostics" href="reduced_diags.html" />
    <link rel="prev" title="Visualization with yt (for plotfiles)" href="yt.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> WarpX
          

          
          </a>

          
            
            
              <div class="version">
                20.02
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../building/building.html">Building/installing WarpX</a></li>
<li class="toctree-l1"><a class="reference internal" href="../running_cpp/running_cpp.html">Running WarpX as an executable</a></li>
<li class="toctree-l1"><a class="reference internal" href="../running_python/running_python.html">Running WarpX from Python</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="visualization.html">Visualizing the simulation results</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="yt.html">Visualization with yt (for plotfiles)</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Visualizing back-transformed diagnostics</a></li>
<li class="toctree-l2"><a class="reference internal" href="reduced_diags.html">Reduced diagnostics</a></li>
<li class="toctree-l2"><a class="reference internal" href="visit.html">Visualization with Visit (for plotfiles)</a></li>
<li class="toctree-l2"><a class="reference internal" href="picviewer.html">PyQt-based visualization GUI: PICViewer (for both plotfiles and openPMD)</a></li>
<li class="toctree-l2"><a class="reference internal" href="openpmdviewer.html">Visualization with openPMD-viewer (for openPMD data)</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced.html">Advanced yt visualization, for developers (for plotfiles)</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_parallel.html">Out-of-the-box plotting script</a></li>
<li class="toctree-l2"><a class="reference internal" href="sensei.html">In situ Visualization with SENSEI</a></li>
<li class="toctree-l2"><a class="reference internal" href="ascent.html">In situ Visualization with Ascent</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../theory/theory.html">Theoretical background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developers/developers.html">Developers documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developers/doxygen.html">Doxygen</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">WarpX</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="visualization.html">Visualizing the simulation results</a> &raquo;</li>
        
      <li>Visualizing back-transformed diagnostics</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/visualization/backtransformed_diags.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="visualizing-back-transformed-diagnostics">
<h1>Visualizing back-transformed diagnostics<a class="headerlink" href="#visualizing-back-transformed-diagnostics" title="Permalink to this headline">¶</a></h1>
<p>When running a simulation in a boosted frame, WarpX has the capability to
back-transform the simulation results to the laboratory frame of reference, which
is often useful to study the physics. A set of functions can be found in the
python file <a class="reference download internal" download="" href="../_downloads/29c779f709c184a1fe7fa99a2e594814/read_raw_data.py"><code class="xref download docutils literal notranslate"><span class="pre">read_raw_data.py</span></code></a>. The main commands can be found in our example jupyter notebook for postprocessing <a class="reference download internal" download="" href="../_downloads/f6729b9013c3b57f9d96663a0a6dd554/Visualization.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Visualization.ipynb</span></code></a>.</p>
<p>The full back-transformed diagnostics of the entire domain is written in <code class="docutils literal notranslate"><span class="pre">lab_frame_data/snapshots/</span></code> and the back-transformed diagnostics of the reduced domain is written to <code class="docutils literal notranslate"><span class="pre">lab_frame_data/slices/</span></code>
For instance: To plot the <code class="docutils literal notranslate"><span class="pre">Ez</span></code> field along the z-direction at the center of the 3D-domain of the full back-transformed diagnostics for the entire 3D domain:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span>import read_raw_data
import matplotlib.pyplot as plt

iteration = 0
field = &#39;Ez&#39;
snapshot = &#39;./lab_frame_data/snapshots/&#39; + &#39;snapshot&#39; + str(iteration).zfill(5)
header   = &#39;./lab_frame_data/snapshots/Header&#39;
allrd, info = read_raw_data.read_lab_snapshot(snapshot, header) # Read field data
F = allrd[field]
plt.plot(F[F.shape[0]//2,F.shape[1]//2-1,:])
</pre></div>
</div>
<p>Similarly, the back-transformed diagnostics on a reduced domain (1D line, 2D slice, 3D reduced diagnostic) can also be visualized using read_raw_data.py. For instance – let us say that the user-input is an “x-z” slice (at the center of the domain in the “y-direction”), then, to plot <code class="docutils literal notranslate"><span class="pre">Ez</span></code> on this x-z slice:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span>iteration = 0
field = &#39;Ez&#39;
snapshot = &#39;./lab_frame_data/slices/&#39; + &#39;slice&#39; + str(iteration).zfill(5)
header   = &#39;./lab_frame_data/slices/Header&#39;
allrd, info = read_raw_data.read_lab_snapshot(snapshot, header) # Read field data
F_RD = allrd[field]
plt.plot(F_RD[F_RD.shape[0]//2,0,:])
</pre></div>
</div>
<p>Note that, in the above snippet, we compare the 0th cell of the reduced diagnostic with <code class="docutils literal notranslate"><span class="pre">F.shape[1]//2-1</span></code>. For an x-z slice at y=y-mid of the domain, two cells are extracted at the center to ensure that the data format is HDF5 compliant. Let us consider that the domain consists of four cells in the y-dimension: [0,1,2,3], Then the 2D slice would contain the data that corresponds to [1,2]. That is the 0th cell of the reduced diagnostic corresponds to <code class="docutils literal notranslate"><span class="pre">ny/2-1</span></code>, (where, ny is the number of cells in the y-dimension).</p>
<p>If the back-transformed diagnostics are written in the HDF5 format (This can be done by compiling WarpX with USE_HDF5=TRUE), then the full domain snapshot and reduced domain diagnostics can be visualized using h5py:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span>import matplotlib.pyplot as plt
import h5py

f1 = h5py.File(&#39;lab_frame_data/snapshots/snapshot00000&#39;, &#39;r&#39;)
nx1 = f1[&#39;Ez&#39;].shape[0]
ny1 = f1[&#39;Ez&#39;].shape[1]
nz1 = f1[&#39;Ez&#39;].shape[2]
plt.plot(f1[&#39;Ez&#39;][nx1//2,ny1//2-1,:])

f2 = h5py.File(&#39;lab_frame_data/slices/slice00000&#39;, &#39;r&#39;)
nx2 = f2[&#39;Ez&#39;].shape[0]
ny2 = f2[&#39;Ez&#39;].shape[1]
nz2 = f2[&#39;Ez&#39;].shape[2]
plt.figure()
plt.plot(f2[&#39;Ez&#39;][nx2//2,0,:])
</pre></div>
</div>
<p>The back-transformed particle data on the full and reduced diagnostic can be visualized as follows</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span>species=&#39;ions&#39;
iteration = 1

snapshot = &#39;./lab_frame_data/snapshots/&#39; + &#39;snapshot&#39; + str(iteration).zfill(5)
xbo = get_particle_field(snapshot, species, &#39;x&#39;) # Read particle data
ybo = get_particle_field(snapshot, species, &#39;y&#39;)
zbo = get_particle_field(snapshot, species, &#39;z&#39;)

snapshot = &#39;./lab_frame_data/slices/&#39; + &#39;slice&#39; + str(iteration).zfill(5)
xbo_slice = get_particle_field(snapshot, species, &#39;x&#39;) # Read particle data
ybo_slice = get_particle_field(snapshot, species, &#39;y&#39;)
zbo_slice = get_particle_field(snapshot, species, &#39;z&#39;)
plt.figure()
plt.plot(xbo, ybo, &#39;r.&#39;, markersize=1.)
plt.plot(xbo_slice, ybo_slice, &#39;bx&#39;, markersize=1.)
</pre></div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="reduced_diags.html" class="btn btn-neutral float-right" title="Reduced diagnostics" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="yt.html" class="btn btn-neutral float-left" title="Visualization with yt (for plotfiles)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, WarpX collaboration

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>